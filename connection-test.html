<!DOCTYPE html>
<html>
<head>
    <title>Quick Connection Test</title>
</head>
<body>
    <h1>Collaboration Connection Test</h1>
    <div id="status">Testing connections...</div>
    <div id="details"></div>

    <script>
        const statusDiv = document.getElementById('status');
        const detailsDiv = document.getElementById('details');
        
        function addLog(message) {
            detailsDiv.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + message + '</div>';
        }

        // Test Angular server
        fetch('http://localhost:4200')
            .then(response => {
                addLog('‚úÖ Angular server reachable (status: ' + response.status + ')');
                return testSocketIO();
            })
            .catch(error => {
                addLog('‚ùå Angular server not reachable: ' + error.message);
                return testSocketIO();
            });

        // Test Socket.IO server
        function testSocketIO() {
            fetch('http://localhost:3001/health')
                .then(response => response.json())
                .then(data => {
                    addLog('‚úÖ Socket.IO server reachable: ' + JSON.stringify(data));
                    testWebSocket();
                })
                .catch(error => {
                    addLog('‚ùå Socket.IO server not reachable: ' + error.message);
                });
        }

        // Test WebSocket connection
        function testWebSocket() {
            addLog('üîå Testing WebSocket connection...');
            
            const script = document.createElement('script');
            script.src = 'http://localhost:3001/socket.io/socket.io.js';
            script.onload = function() {
                const socket = io('http://localhost:3001');
                
                socket.on('connect', function() {
                    addLog('‚úÖ WebSocket connected with ID: ' + socket.id);
                    statusDiv.innerHTML = '‚úÖ All connections working!';
                    socket.disconnect();
                });
                
                socket.on('connect_error', function(error) {
                    addLog('‚ùå WebSocket connection error: ' + error.message);
                    statusDiv.innerHTML = '‚ùå WebSocket connection failed';
                });
            };
            
            script.onerror = function() {
                addLog('‚ùå Could not load Socket.IO client library');
                statusDiv.innerHTML = '‚ùå Socket.IO client library not accessible';
            };
            
            document.head.appendChild(script);
        }

        // Browser detection
        addLog('üîç Browser: ' + navigator.userAgent);
        addLog('üîç Cookies enabled: ' + navigator.cookieEnabled);
        addLog('üîç Local storage available: ' + (typeof Storage !== 'undefined'));
    </script>
</body>
</html>